<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Purple Clicker</title>

<!-- cache-busting -->
<link rel="stylesheet" href="style.css?v=FINAL1">
</head>
<body>

<div class="game">
    <h1>âš¡ Modern Clicker</h1>

    <div class="stats">
        <div>Clicks<br><span id="clicks">0</span></div>
        <div>Per Click<br><span id="perClick">1</span></div>
        <div>Auto/sec<br><span id="autoClick">0</span></div>
    </div>

    <button id="clickBtn">CLICK</button>

    <h2>Upgrades</h2>

    <div class="upgrades">
        <button id="clickUpgrade">
            +1 Click Power<br>
            Cost: <span id="clickCost">10</span>
        </button>

        <button id="autoUpgrade">
            Auto Clicker (+1/sec)<br>
            Cost: <span id="autoCost">50</span>
        </button>
    </div>

    <button id="soundBtn">ðŸ”Š Sound ON</button>
</div>

<!-- sounds -->
<audio id="clickSound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-game-click-1114.mp3">
</audio>

<audio id="buySound" preload="auto">
    <source src="https://assets.mixkit.co/sfx/preview/mixkit-game-upgrade-2062.mp3">
</audio>

<script>
/* ======================
   GAME STATE
====================== */
let data = {
    clicks: 0,
    perClick: 1,
    autoClick: 0,
    clickCost: 10,
    autoCost: 50,
    sound: true
};

/* ======================
   LOAD SAVE (SAFE)
====================== */
try {
    const save = localStorage.getItem("purpleClickerSave");
    if (save) {
        const s = JSON.parse(save);
        data.clicks = Number(s.clicks) || 0;
        data.perClick = Number(s.perClick) || 1;
        data.autoClick = Number(s.autoClick) || 0;
        data.clickCost = Number(s.clickCost) || 10;
        data.autoCost = Number(s.autoCost) || 50;
        data.sound = s.sound !== false;
    }
} catch (e) {
    console.warn("Save load failed, reset used.");
}

/* ======================
   ELEMENTS
====================== */
const clicksEl = document.getElementById("clicks");
const perClickEl = document.getElementById("perClick");
const autoEl = document.getElementById("autoClick");
const clickCostEl = document.getElementById("clickCost");
const autoCostEl = document.getElementById("autoCost");
const clickBtn = document.getElementById("clickBtn");
const soundBtn = document.getElementById("soundBtn");

const clickSound = document.getElementById("clickSound");
const buySound = document.getElementById("buySound");

/* ======================
   FUNCTIONS
====================== */
function saveGame() {
    localStorage.setItem("purpleClickerSave", JSON.stringify(data));
}

function updateUI() {
    clicksEl.textContent = Math.floor(data.clicks);
    perClickEl.textContent = data.perClick;
    autoEl.textContent = data.autoClick;
    clickCostEl.textContent = data.clickCost;
    autoCostEl.textContent = data.autoCost;
    soundBtn.textContent = data.sound ? "ðŸ”Š Sound ON" : "ðŸ”‡ Sound OFF";
    saveGame();
}

function playSound(sound) {
    if (!data.sound) return;
    const s = sound.cloneNode();
    s.volume = 0.5;
    s.play().catch(()=>{});
}

/* ======================
   CLICK BUTTON
====================== */
clickBtn.addEventListener("click", () => {
    data.clicks += data.perClick;
    playSound(clickSound);
    animateClick();
    updateUI();
});

/* ======================
   UPGRADES
====================== */
document.getElementById("clickUpgrade").onclick = () => {
    if (data.clicks >= data.clickCost) {
        data.clicks -= data.clickCost;
        data.perClick++;
        data.clickCost = Math.floor(data.clickCost * 1.6);
        playSound(buySound);
        updateUI();
    }
};

document.getElementById("autoUpgrade").onclick = () => {
    if (data.clicks >= data.autoCost) {
        data.clicks -= data.autoCost;
        data.autoClick++;
        data.autoCost = Math.floor(data.autoCost * 2);
        playSound(buySound);
        updateUI();
    }
};

/* ======================
   SOUND TOGGLE
====================== */
soundBtn.onclick = () => {
    data.sound = !data.sound;
    updateUI();
};

/* ======================
   AUTO CLICK LOOP
====================== */
setInterval(() => {
    if (data.autoClick > 0) {
        data.clicks += data.autoClick;
        updateUI();
    }
}, 1000);

/* ======================
   FLOATING TEXT
====================== */
function animateClick() {
    const f = document.createElement("div");
    f.className = "float";
    f.textContent = `+${data.perClick}`;
    document.body.appendChild(f);

    const r = clickBtn.getBoundingClientRect();
    f.style.left = r.left + r.width / 2 + "px";
    f.style.top = r.top + "px";

    setTimeout(() => f.remove(), 800);
}

/* INIT */
updateUI();
</script>

</body>
</html>
