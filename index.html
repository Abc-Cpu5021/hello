<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Modern Clicker</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css?v=FINAL">
</head>

<body class="bg-1">
<canvas id="bgParticles"></canvas>

<div class="game">

<h1>‚ö° Modern Clicker</h1>

<div class="stats">
  <div>Clicks<br><span id="clicks">0</span></div>
  <div>Per Click<br><span id="perClick">1</span></div>
  <div>Auto/sec<br><span id="autoClick">0</span></div>
</div>

<div class="world-info">
  üåç World: <span id="worldName"></span><br>
  ‚úñ Multiplier: <span id="multi"></span><br>
  üîÅ Rebirths: <span id="rebirths"></span>
</div>

<button id="clickBtn">CLICK</button>

<h2>Upgrades</h2>
<button onclick="buyClick()">+1 Click (Cost <span id="clickCost"></span>)</button>
<button onclick="buyAuto()">+1 Auto (Cost <span id="autoCost"></span>)</button>
<button onclick="buyWorld()" id="worldBtn">Unlock World (Cost <span id="worldCost"></span>)</button>

<h2>Rebirth</h2>
<button onclick="rebirth()">REBIRTH (Cost 1,000,000)</button>

<h2>Jackpot</h2>
<input id="betAmount" type="number" placeholder="Bet clicks">
<div class="casino">
  <button class="red" onclick="gamble('red')">RED</button>
  <button class="black" onclick="gamble('black')">BLACK</button>
</div>
<div id="casinoResult"></div>

</div>

<script>
/* ===== HARD SAFE RESET ===== */
const SAVE_KEY = "clickerSave_v2";

/* ===== DEFAULT DATA ===== */
const DEFAULT = {
  clicks: 0,
  perClick: 1,
  autoClick: 0,
  clickCost: 10,
  autoCost: 50,
  world: 1,
  worldCost: 1000,
  rebirths: 0
};

/* ===== LOAD SAFE ===== */
function loadData(){
  try{
    const raw = JSON.parse(localStorage.getItem(SAVE_KEY));
    if(!raw) return {...DEFAULT};
    for(const k in DEFAULT){
      if(typeof raw[k] !== "number" || !isFinite(raw[k])) return {...DEFAULT};
    }
    raw.world = Math.max(1, Math.min(4, raw.world));
    return raw;
  }catch{
    return {...DEFAULT};
  }
}

let d = loadData();

/* ===== WORLDS ===== */
const worlds = [
  "Spark Realm",
  "Neon Void",
  "Aqua Nexus",
  "Inferno Core"
];

const g = id => document.getElementById(id);

function multiplier(){
  return Math.max(1, (2 ** (d.world - 1)) * (2 ** d.rebirths));
}

/* ===== UI ===== */
function updateUI(){
  g("clicks").textContent = Math.floor(d.clicks);
  g("perClick").textContent = d.perClick;
  g("autoClick").textContent = d.autoClick;
  g("clickCost").textContent = d.clickCost;
  g("autoCost").textContent = d.autoCost;
  g("worldCost").textContent = d.worldCost;
  g("rebirths").textContent = d.rebirths;
  g("worldName").textContent = worlds[d.world - 1];
  g("multi").textContent = "x" + multiplier();

  document.body.className = "bg-" + d.world;

  const btn = g("worldBtn");
  if(d.world >= 4){
    btn.textContent = "MAX WORLD";
    btn.disabled = true;
  }

  localStorage.setItem(SAVE_KEY, JSON.stringify(d));
}

/* ===== CLICK ===== */
g("clickBtn").onclick = e => {
  d.clicks += d.perClick * multiplier();
  updateUI();
};

/* ===== UPGRADES ===== */
function buyClick(){
  if(d.clicks >= d.clickCost){
    d.clicks -= d.clickCost;
    d.perClick++;
    d.clickCost = Math.floor(d.clickCost * 1.4);
    updateUI();
  }
}

function buyAuto(){
  if(d.clicks >= d.autoCost){
    d.clicks -= d.autoCost;
    d.autoClick++;
    d.autoCost = Math.floor(d.autoCost * 1.6);
    updateUI();
  }
}

function buyWorld(){
  if(d.world < 4 && d.clicks >= d.worldCost){
    d.clicks -= d.worldCost;
    d.world++;
    d.worldCost *= 5;
    updateUI();
  }
}

/* ===== REBIRTH ===== */
function rebirth(){
  if(d.clicks >= 1_000_000){
    d = {...DEFAULT, rebirths: d.rebirths + 1};
    updateUI();
  }
}

/* ===== AUTO ===== */
setInterval(()=>{
  d.clicks += d.autoClick * multiplier();
  updateUI();
},1000);

/* ===== JACKPOT ===== */
function gamble(choice){
  const bet = Number(g("betAmount").value);
  if(!bet || bet <= 0 || bet > d.clicks) return;

  const win = Math.random() < 0.5 ? "red" : "black";
  if(choice === win){
    d.clicks += bet;
    g("casinoResult").textContent = "YOU WON x2!";
  }else{
    d.clicks -= bet;
    g("casinoResult").textContent = "YOU LOST!";
  }
  updateUI();
}

updateUI();
</script>
</body>
</html>
